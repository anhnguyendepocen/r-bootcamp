---
title: "Visualization"
author: "MC"
output:   
    ioslides_presentation:
      highlight: zenburn
      smaller: yes
      theme: readable
      widescreen: no
      css: mainPresentation.css
---

## Outline
- Traditional Static Plotting
  - Base R plotting
  - ggplot2
  
- Newer approaches
  - shiny, ggvis, htmlwidgets

# Traditional Static Plotting
## Traditional Static Plotting

Never forget that Base R has a lot of visualization capabilities that can produce high quality graphs

For many quick peeks, it's still often to be preferred.

<div class='columns-2'>
```{r histogram, fig.align='left', fig.width=3, fig.height=3, results='hold'}
x = rnorm(100)
y = 2*x^2 + rnorm(100)
hist(x)
```

<br>

```{r basicPlot, fig.align='right', fig.width=3, fig.height=3}
plot(x, y)
```
</div>


## Traditional Static Plotting
Unfortunately base R plots can take a lot to get to that professional quality, as the defaults are generally poor (my opinion)

Many packages or other base R functions serve a particular purpose

  - heatmaps, dendrograms, diagnostics correlation plots etc.

In addition, a widely used static plotting package is ggplot2

## ggplot2

ggplot2 is based on the 'Grammar of Graphics' and takes on a layered approach to building visualizations, using a technique similar to the piping we showed earlier.

It primarily works on dataframes.

```{r ggplot2}
library(ggplot2)

ggplot(aes(x=Petal.Length, y=Sepal.Length), data=iris) +
  geom_point()
```

## ggplot2

ggplot2 works on certain 'aesthetics', which are typically variables that take on different values, with 'geoms', things like points, lines, densities etc.

Let's add more.

```{r gg2}
ggplot(aes(x=Petal.Length, y=Sepal.Length), data=iris) +
  geom_point(color='red', size=4, alpha=.5)  # not within aesthetic function
```

## ggplot2
```{r gg3}
ggplot(aes(x=Petal.Length, y=Sepal.Length), data=iris) +
  geom_point(aes(color=Species)) +
  theme_minimal()
```

## You try
Install ggplot2 if you haven't.

Change the aesthetics in the first line to look at Widths instead of Lengths.

Delete the interior portion of geom\_point (i.e. it should look like geom\_point()).

Add the following lines after the geom, keep the theme at the end if you want.

```{r gg4, eval=FALSE}
  geom_smooth() +
  facet_wrap(~Species) +
```

If you like, use facet_grid rather than wrap.


## Newer approaches
ggplot2 was and still is an awesome tool and still very useful for standard static plots.

- And has continued to develop even as the creator has moved on

However, ggvis, its successor, enables interactivity and is more web-oriented.

Furthermore there is a growing number of packages put out by Rstudio and others that embrace modern methods of visual display.


## ggvis

The following shows how to do one of the previous plots with ggvis.

```{r ggvis, message=FALSE}
library(ggvis)
ggvis(x=~Petal.Length, y=~Sepal.Length, data=iris) %>% 
  layer_points(fill=~Species, fillOpacity:=.75) 
```

It's already a clean looking plot, and ready to add interactive components.

## ggvis

As before, we'll build up from the above. 

Try to add layer_smooths to the code, with an argument se=TRUE.

```{r ggvis2, eval=FALSE}
ggvis(x=~Petal.Length, y=~Sepal.Length, data=iris) %>% 
  layer_points(fill=~Species, fillOpacity:=.75) 
```

```{r ggvis3, echo=F, eval=T}
library(ggvis)
ggvis(x=~Petal.Length, y=~Sepal.Length, data=iris) %>% 
  layer_points(fill=~Species, fillOpacity:=.75) %>% 
  group_by(Species) %>% 
  layer_smooths(stroke=~Species, se=T)
```

## Going further

Search htmlwidgest showcase 

- http://www.htmlwidgets.org/showcase_leaflet.html
- All of these are geared toward making interactive graphics as easy to procure as the normal ones.
- We demonstrated leaflet before

Shiny

- http://shiny.rstudio.com/gallery/
- We could have spent all of today on shiny.

My own (with Josh's assistance) demo using these tools.

- https://micl.shinyapps.io/texEx/texEx.Rmd

## Things to think about with visualization

Cleaner is almost always better

Think multivariately (beyond bivariate)

- e.g. there is never a good reason for bar plot

Think interactively

~10% of the population has some form of color blindness. 

Avoid maps that just regurgitate population

Color is not 'extra'